<div class="entidad-container">
  <h2>Inmobiliarias</h2>

  <!-- FILTROS -->
  <div class="filtros-container">
    <h3>Buscar inmobiliarias</h3>

    <div class="filtros-grid">
      <!-- Filtro estado -->
      <div class="filtro-item">
        <label class="filtro-label">Estado</label>
        <select [(ngModel)]="searchEstado" class="filtro-input">
          <option value="">Todos</option>
          <option value="true">Activo</option>
          <option value="false">Inactivo</option>
        </select>
      </div>

      <!-- Filtro situaci√≥n inmobiliaria -->
      <div class="filtro-item">
        <label class="filtro-label">Situaci√≥n inmobiliaria</label>
        <input
          type="text"
          [(ngModel)]="searchSituacion"
          class="filtro-input"
          placeholder="Ej: En construcci√≥n"
        />
      </div>

      <!-- Filtro ubicaci√≥n -->
      <div class="filtro-item">
        <label class="filtro-label">Ubicaci√≥n</label>
        <input
          type="text"
          [(ngModel)]="searchUbicacion"
          class="filtro-input"
          placeholder="Ej: Lima, Miraflores"
        />
      </div>

      <!-- Botones b√∫squeda/limpiar -->
      <div class="filtro-item botones-filtro">
        <button type="button" (click)="buscarInmobiliarias()" class="btn-primario">
          Buscar
        </button>
        <button type="button" (click)="limpiarFiltros()" class="btn-secundario">
          Limpiar
        </button>
      </div>
    </div>
  </div>

  <!-- Bot√≥n Registrar inmobiliaria -->
  <div class="acciones-header">
    <button type="button" (click)="registrarInmobiliaria()" class="btn-primario">
      Registrar inmobiliaria
    </button>
  </div>

  <!-- MENSAJES DE ESTADO -->
  <div *ngIf="loading" class="estado">Cargando informaci√≥n...</div>

  <div *ngIf="!loading && errorMessage" class="estado error">
    {{ errorMessage }}
  </div>

  <div
    *ngIf="!loading && !errorMessage && !pagedInmobiliarias.length"
    class="estado"
  >
    No hay propiedades registradas.
  </div>

  <!-- TABLA + FOOTER -->
  <ng-container
    *ngIf="
      !loading && !errorMessage && pagedInmobiliarias.length > 0
    "
  >
    <table class="tabla-entidades">
      <thead>
        <tr>
          <th>Ubicaci√≥n</th>
          <th>√Årea</th>
          <th>Precio</th>
          <th>Situaci√≥n</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let inmobiliaria of pagedInmobiliarias">
          <td>{{ inmobiliaria.ubicacion }}</td>
          <td>{{ inmobiliaria.area }} m¬≤</td>
          <td>{{ inmobiliaria.precio | currency }}</td>
          <td>{{ inmobiliaria.situacion_inmobiliaria }}</td>
          <td>
            {{ inmobiliaria.estado ? 'Activo' : 'Inactivo' }}
          </td>
          <td>
            <div class="acciones-tabla">
              <button
                type="button"
                (click)="verInmobiliaria(inmobiliaria)"
                title="Ver"
                class="btn-accion btn-accion-ver"
              >
                üëÅ
              </button>

              <button
                type="button"
                (click)="editarInmobiliaria(inmobiliaria)"
                title="Editar"
                class="btn-accion btn-accion-editar"
              >
                ‚úèÔ∏è
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- FOOTER PAGINACI√ìN (mismo formato que el ejemplo) -->
    <div class="footer-paginacion">
      <!-- Selector de tama√±o de p√°gina -->
      <div class="footer-left">
        Mostrar
        <select
          class="selector-pagina"
          [ngModel]="pageSize"
          (ngModelChange)="onPageSizeChange($event)"
        >
          <option *ngFor="let size of pageSizeOptions" [value]="size">
            {{ size }}
          </option>
        </select>
        por p√°gina
      </div>

      <!-- Paginaci√≥n -->
      <div class="footer-right">
        <span>{{ inicio }}‚Äì{{ fin }} de {{ totalItems }}</span>

        <div class="paginacion-botones">
          <button
            type="button"
            class="btn-paginacion"
            (click)="irPaginaAnterior()"
            [disabled]="currentPage <= 1"
          >
            ‚Äπ
          </button>

          <button
            *ngFor="let num of paginasVisibles"
            type="button"
            (click)="irPagina(num)"
            [ngClass]="{
              'btn-paginacion-activa': num === currentPage,
              'btn-paginacion-normal': num !== currentPage
            }"
            class="btn-paginacion"
          >
            {{ num }}
          </button>

          <span *ngIf="showEllipsis">...</span>

          <button
            type="button"
            class="btn-paginacion"
            (click)="irPaginaSiguiente()"
            [disabled]="currentPage >= totalPages"
          >
            ‚Ä∫
          </button>
        </div>
      </div>
    </div>
  </ng-container>
</div>

<!-- MODAL DETALLE -->
<div
  *ngIf="showDetalleModal"
  class="modal-overlay"
  (click)="cerrarDetalleModal()"
>
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button
      type="button"
      class="modal-close"
      (click)="cerrarDetalleModal()"
    >
      √ó
    </button>

    <h3 class="modal-title">Detalle de inmobiliaria</h3>

    <div *ngIf="loadingDetalle" class="estado">
      Cargando informaci√≥n...
    </div>

    <div *ngIf="!loadingDetalle && selectedInmobiliaria">
      <div class="modal-grid">
        <div>
          <p class="modal-label">Ubicaci√≥n</p>
          <p class="modal-value">
            {{ selectedInmobiliaria.ubicacion }}
          </p>
        </div>

        <div>
          <p class="modal-label">√Årea</p>
          <p class="modal-value">
            {{ selectedInmobiliaria.area }} m¬≤
          </p>
        </div>

        <div>
          <p class="modal-label">Precio</p>
          <p class="modal-value">
            {{ selectedInmobiliaria.precio | currency }}
          </p>
        </div>

        <div>
          <p class="modal-label">Situaci√≥n inmobiliaria</p>
          <p class="modal-value">
            {{ selectedInmobiliaria.situacion_inmobiliaria }}
          </p>
        </div>

        <div>
          <p class="modal-label">Estado</p>
          <p class="modal-value">
            {{ selectedInmobiliaria.estado ? 'Activo' : 'Inactivo' }}
          </p>
        </div>

        <div *ngIf="selectedInmobiliaria.descripcion" class="modal-descripcion">
          <p class="modal-label">Descripci√≥n</p>
          <p class="modal-descripcion-text">
            {{ selectedInmobiliaria.descripcion }}
          </p>
        </div>
      </div>

      <div class="modal-imagen" *ngIf="detalleImageUrl">
        <img
          [src]="detalleImageUrl"
          alt="Imagen de la inmobiliaria"
        />
      </div>

      <div class="modal-footer">
        <button
          type="button"
          class="btn-primario"
          (click)="cerrarDetalleModal()"
        >
          Cerrar
        </button>
      </div>
    </div>
  </div>
</div>